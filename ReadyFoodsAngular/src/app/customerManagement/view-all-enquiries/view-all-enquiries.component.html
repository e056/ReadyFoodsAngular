<h1>View All Enquiries</h1>


<p-table #enquiryDataTable [value]="enquiries" dataKey="id" [rows]="10" [showCurrentPageReport]="true"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" responsiveLayout="scroll"
    [rowsPerPageOptions]="[10,25,50]" [paginator]="true"
    [globalFilterFields]="['enquiryId','title','description','resolved','customer.firstName']">
    <ng-template pTemplate="caption">
        <div class="flex">
            <input pInputText type="text"
                (input)="enquiryDataTable.filterGlobal($any($event.target).value , 'contains')"
                placeholder="Search keyword" />

        </div>
    </ng-template>
    <ng-template pTemplate="header">
        <!-- THIS IS THE HEADER LINE WITH FILTERS -->
        <tr>
            <th>
                <div>
                    ID
                    <p-columnFilter type="numeric" field="balance" display="menu"></p-columnFilter>
                </div>
            </th>

            <th>Customer</th>
            <th>
                <div class="flex justify-content-center align-items-center">
                    Resolved
                    <p-columnFilter type="boolean" field="resolved" display="menu"></p-columnFilter>
                </div>
            </th>
            <th>Action</th>
        </tr>
    </ng-template>
    <!-- THIS IS THE BODY -->
    <ng-template pTemplate="body" let-enquiry>
        <tr>
            <td>{{enquiry.enquiryId}}</td>
            <td>{{enquiry.customer.firstName}} {{enquiry.customer.lastName}}</td>
            <td><span [class]="'enquiry-badge-' + enquiry.resolved">{{enquiry.resolved}}</span></td>
            <td>
                <p-button label="View" (onClick)="showDialog(enquiry)"></p-button>
            </td>
        </tr>
    </ng-template>
</p-table>


<p-dialog *ngIf="display" header="Enquiry ID: {{enquiryToView.enquiryId}}" [(visible)]="display"
    [style]="{width: '50vw'}">
    <div class="ui-g">

        <p-panel header="From:  {{(enquiryToView.customer != null)?(enquiryToView.customer.firstName):('')}}">
           
            <p>{{enquiryToView.title}}</p>
            <p>{{enquiryToView.description}}</p>
        </p-panel>
        <br />
        <p-panel header="Actions">
            <textarea placeholder="Staff response" rows="5" [cols]="30" pInputTextarea autoResize="autoResize"></textarea>
            <br />
            <p-button label="Respond"></p-button>
        </p-panel>

        <br />
    </div>


</p-dialog>